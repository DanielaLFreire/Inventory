# üå≤ Sistema Completo Integrado de Invent√°rio Florestal

Aplica√ß√£o web avan√ßada para an√°lise completa de invent√°rios florestais, integrando modelos hipsom√©tricos, volum√©tricos e estimativas de produ√ß√£o florestal em um sistema unificado.

## üìã Descri√ß√£o

Este sistema revoluciona a an√°lise de invent√°rios florestais ao integrar **tr√™s etapas sequenciais** em uma √∫nica aplica√ß√£o:

1. **üå≥ An√°lise Hipsom√©trica** - Testa 7 modelos e seleciona automaticamente o melhor
2. **üìä An√°lise Volum√©trica** - Processa cubagem e compara 4 modelos de volume
3. **üìà Invent√°rio Integrado** - Aplica os melhores modelos e gera an√°lises completas

O diferencial √© a **sele√ß√£o autom√°tica** dos melhores modelos e **integra√ß√£o fluida** entre as etapas, eliminando a necessidade de m√∫ltiplas ferramentas.

## ‚ú® Funcionalidades Principais

### üìÅ **Upload e Processamento Inteligente**
- Suporte **robusto** para arquivos **CSV**, **Excel** (.xlsx, .xls, .xlsb)
- **Detec√ß√£o autom√°tica** de separadores e engines Excel
- **Valida√ß√£o completa** das colunas necess√°rias
- **Filtros configur√°veis** para talh√µes, di√¢metro m√≠nimo e c√≥digos de √°rvores
- **Tratamento inteligente** de dados faltantes e outliers

### üìä **ETAPA 1: Modelos Hipsom√©tricos (7 Modelos)**

#### Modelos Lineares
- **Curtis**: `ln(H) = Œ≤‚ÇÄ + Œ≤‚ÇÅ √ó (1/D)`
- **Campos**: `ln(H) = Œ≤‚ÇÄ + Œ≤‚ÇÅ √ó (1/D) + Œ≤‚ÇÇ √ó ln(H_dom)`
- **Henri**: `H = Œ≤‚ÇÄ + Œ≤‚ÇÅ √ó ln(D)`
- **Prodan**: `D¬≤/(H-1.3) = Œ≤‚ÇÄ + Œ≤‚ÇÅ √ó D + Œ≤‚ÇÇ √ó D¬≤ + Œ≤‚ÇÉ √ó D √ó Idade`

#### Modelos N√£o-Lineares
- **Chapman-Richards**: `H = b‚ÇÄ √ó (1 - exp(-b‚ÇÅ √ó D))^b‚ÇÇ`
- **Weibull**: `H = a √ó (1 - exp(-b √ó D^c))`
- **Mononuclear**: `H = a √ó (1 - b √ó exp(-c √ó D))`

### üìä **ETAPA 2: Modelos Volum√©tricos (4 Modelos)**
- **Schumacher-Hall**: `ln(V) = Œ≤‚ÇÄ + Œ≤‚ÇÅ√óln(D) + Œ≤‚ÇÇ√óln(H)`
- **G1**: `ln(V) = Œ≤‚ÇÄ + Œ≤‚ÇÅ√óln(D) + Œ≤‚ÇÇ√ó(1/D)`
- **G2**: `V = Œ≤‚ÇÄ + Œ≤‚ÇÅ√óD¬≤ + Œ≤‚ÇÇ√óD¬≤H + Œ≤‚ÇÉ√óH`
- **G3**: `ln(V) = Œ≤‚ÇÄ + Œ≤‚ÇÅ√óln(D¬≤H)`

**M√©todo de Cubagem**: F√≥rmula de Smalian com exclus√£o autom√°tica do toco

### üîß **An√°lise Detalhada por Modelo**
- **Abas individuais** para cada modelo com:
  - **Equa√ß√µes LaTeX** profissionais
  - **Coeficientes detalhados** com signific√¢ncia estat√≠stica
  - **Gr√°ficos espec√≠ficos** (observado vs predito)
  - **An√°lise de res√≠duos** (scatter + histograma)
  - **Classifica√ß√£o qualitativa** (Excelente, Muito Bom, Bom, Regular, Fraco)
  - **Ranking autom√°tico** por performance

### üìà **ETAPA 3: Invent√°rio Integrado**
- **Aplica√ß√£o autom√°tica** dos melhores modelos selecionados
- **Estimativas por parcela** com volumes e produtividade
- **An√°lise por talh√£o** com estat√≠sticas consolidadas
- **Classifica√ß√£o de produtividade** autom√°tica (Alta, M√©dia, Baixa)
- **C√°lculo de IMA** (Incremento M√©dio Anual - m¬≥/ha/ano)

### üìä **M√©tricas de Avalia√ß√£o Avan√ßadas**
- **R¬≤ Generalizado** para modelos hipsom√©tricos
- **R¬≤ Padr√£o** para modelos volum√©tricos
- **RMSE** (Raiz do Erro Quadr√°tico M√©dio)
- **MAE** (Erro Absoluto M√©dio)
- **Estat√≠stica F** e **signific√¢ncia** para modelos lineares
- **Rankings autom√°ticos** com classifica√ß√£o qualitativa

### üìä **Visualiza√ß√µes Interativas**
- **Gr√°ficos comparativos** de todos os modelos
- **An√°lise de res√≠duos** detalhada por modelo
- **Distribui√ß√£o de produtividade** por talh√£o
- **Correla√ß√µes m√∫ltiplas** (DAP vs Altura vs Volume vs Idade)
- **Classifica√ß√£o visual** de s√≠tios

### üíæ **Exporta√ß√£o Completa de Resultados**
- **Invent√°rio final** com estimativas (CSV)
- **Dados de cubagem** processados (CSV)
- **Resumo por talh√£o** com m√©tricas (CSV)
- **Coeficientes dos modelos** com signific√¢ncia (CSV)
- **Relat√≥rio t√©cnico executivo** completo (Markdown)

## üöÄ Instala√ß√£o e Uso

### Pr√©-requisitos
- **Python 3.12.3** (recomendado) ou superior
- Bibliotecas especificadas no `requirements.txt`

### Instala√ß√£o R√°pida

1. **Clone o reposit√≥rio:**
```bash
git clone <url-do-repositorio>
cd sistema-inventario-florestal
```

2. **Crie um ambiente virtual:**
```bash
python -m venv inventario_env
source inventario_env/bin/activate  # Linux/Mac
# ou
inventario_env\Scripts\activate     # Windows
```

3. **Instale as depend√™ncias:**
```bash
pip install -r requirements.txt
```

### Executando o Sistema

```bash
streamlit run app.py
```

O sistema abrir√° automaticamente no navegador em `http://localhost:8501`

## üìä Formato dos Dados

### üìã **Arquivo de Invent√°rio (Obrigat√≥rio)**

**Colunas obrigat√≥rias:**
- `D_cm`: Di√¢metro √† altura do peito (cm)
- `H_m`: Altura total (m)
- `talhao`: Identifica√ß√£o do talh√£o
- `parcela`: Identifica√ß√£o da parcela
- `cod`: C√≥digo da √°rvore
  - `D` = Dominante
  - `N` = Normal
  - `C` = Cortada
  - `I` = Invasora

**Colunas opcionais:**
- `idade_anos`: Idade do povoamento (necess√°ria para modelo Prodan completo)

### üìè **Arquivo de Cubagem (Obrigat√≥rio)**

**Colunas obrigat√≥rias:**
- `arv`: Identifica√ß√£o √∫nica da √°rvore
- `talhao`: Identifica√ß√£o do talh√£o
- `d_cm`: Di√¢metro da se√ß√£o (cm)
- `h_m`: Altura da se√ß√£o (m)
- `D_cm`: DAP da √°rvore (cm)
- `H_m`: Altura total da √°rvore (m)

### Exemplo de Arquivo de Invent√°rio (CSV)
```csv
talhao,parcela,D_cm,H_m,cod,idade_anos
1,1,15.2,18.5,N,5.2
1,1,18.5,22.1,D,5.2
1,2,12.3,16.2,N,5.2
2,1,20.1,24.3,D,6.1
2,1,16.8,19.8,N,6.1
```

### Exemplo de Arquivo de Cubagem (CSV)
```csv
arv,talhao,d_cm,h_m,D_cm,H_m
1,1,0,0.1,15.2,18.5
1,1,15.2,2.0,15.2,18.5
1,1,12.1,4.0,15.2,18.5
2,1,0,0.1,18.5,22.1
2,1,18.5,2.0,18.5,22.1
```

## üîç Como Usar o Sistema

### **Passo 1: Upload dos Dados**
1. Acesse a barra lateral esquerda
2. Fa√ßa upload do **Arquivo de Invent√°rio**
3. Fa√ßa upload do **Arquivo de Cubagem**
4. O sistema validar√° automaticamente as colunas

### **Passo 2: Configura√ß√µes**
1. **Talh√µes a excluir**: Selecione √°reas experimentais ou Pinus
2. **Di√¢metro m√≠nimo**: Defina crit√©rio m√≠nimo (padr√£o: 4.0 cm)
3. **C√≥digos a excluir**: Remova √°rvores cortadas (C) ou invasoras (I)

### **Passo 3: Execu√ß√£o**
1. Clique em **"üöÄ Executar An√°lise Completa"**
2. O sistema processar√° automaticamente:
   - **ETAPA 1**: Teste dos 7 modelos hipsom√©tricos
   - **ETAPA 2**: Cubagem + 4 modelos volum√©tricos
   - **ETAPA 3**: Invent√°rio final integrado

### **Passo 4: An√°lise dos Resultados**
1. **Explore as abas** de cada modelo individual
2. **Analise gr√°ficos** e coeficientes detalhados
3. **Compare rankings** autom√°ticos
4. **Revise invent√°rio final** com classifica√ß√£o de produtividade

### **Passo 5: Download**
1. **Baixe relat√≥rios** em m√∫ltiplos formatos
2. **Exporte dados** processados
3. **Salve coeficientes** para uso futuro

## üìö Interpreta√ß√£o dos Resultados

### **Classifica√ß√£o de Qualidade dos Modelos**
- **üü¢ Excelente**: R¬≤ ‚â• 0.90
- **üîµ Muito Bom**: 0.80 ‚â§ R¬≤ < 0.90
- **üü° Bom**: 0.70 ‚â§ R¬≤ < 0.80
- **üü† Regular**: 0.60 ‚â§ R¬≤ < 0.70
- **üî¥ Fraco**: R¬≤ < 0.60

### **Classifica√ß√£o de Produtividade**
- **üü¢ Classe Alta**: Produtividade ‚â• Q75 (quartil superior)
- **üü° Classe M√©dia**: Q25 ‚â§ Produtividade < Q75 (quartis intermedi√°rios)
- **üî¥ Classe Baixa**: Produtividade < Q25 (quartil inferior)

### **Signific√¢ncia Estat√≠stica (Modelos Lineares)**
- ***** p < 0.001: Altamente significativo
- **** p < 0.01: Muito significativo
- *** p < 0.05: Significativo
- **. p < 0.1**: Marginalmente significativo
- **(espa√ßo)**: N√£o significativo

## üõ†Ô∏è Depend√™ncias Principais

```txt
streamlit>=1.35.0          # Interface web moderna
pandas>=2.2.0              # Manipula√ß√£o de dados
numpy>=1.26.0              # Opera√ß√µes num√©ricas
matplotlib>=3.8.0          # Visualiza√ß√µes b√°sicas
seaborn>=0.13.0            # Gr√°ficos estat√≠sticos
scikit-learn>=1.4.0        # Modelos de regress√£o
scipy>=1.12.0              # Otimiza√ß√£o e estat√≠stica
openpyxl>=3.1.2            # Arquivos Excel (.xlsx)
xlrd>=2.0.1                # Arquivos Excel (.xls)
pyxlsb>=1.0.10             # Arquivos Excel (.xlsb)
```

### **Instala√ß√£o de Depend√™ncias Excel**
Se houver problemas com arquivos Excel:
```bash
pip install openpyxl xlrd pyxlsb
```

**Alternativa**: Converta arquivos Excel para CSV:
- Excel ‚Üí Arquivo ‚Üí Salvar Como ‚Üí CSV UTF-8

## üìñ Conceitos Importantes

### üèûÔ∏è **Diferen√ßa: S√≠tio vs Classifica√ß√£o de Produtividade**

**S√çTIO FLORESTAL (√çndice de Local)**
- **Conceito**: Capacidade produtiva **inerente** do local
- **Baseado em**: Caracter√≠sticas edafoclim√°ticas (solo, clima, topografia)
- **M√©todo**: Altura dominante √ó idade (curvas de √≠ndice de s√≠tio)
- **Caracter√≠stica**: Propriedade **permanente** do local
- **Aplica√ß√£o**: Planejamento de longo prazo e sele√ß√£o de esp√©cies

**CLASSIFICA√á√ÉO DE PRODUTIVIDADE (Este Sistema)**
- **Conceito**: Performance **atual** observada no invent√°rio
- **Baseado em**: Volume/hectare medido nas parcelas
- **M√©todo**: Estratifica√ß√£o por quartis (Q25, Q75)
- **Caracter√≠stica**: Pode **variar** com manejo e idade
- **Aplica√ß√£o**: An√°lise de desempenho atual e estratifica√ß√£o operacional

### üå≥ **M√©tricas Florestais Importantes**

**IMA (Incremento M√©dio Anual)**
- **F√≥rmula**: `IMA = Volume atual (m¬≥/ha) √∑ Idade (anos)`
- **Significado**: Produtividade m√©dia anual do povoamento
- **Unidade**: m¬≥/ha/ano
- **Aplica√ß√£o**: Compara√ß√£o de produtividade entre talh√µes e idades
- **Exemplo**: Se um talh√£o de 6 anos tem 180 m¬≥/ha ‚Üí IMA = 30 m¬≥/ha/ano

**ICA (Incremento Corrente Anual)**
- **Conceito**: Crescimento no √∫ltimo ano
- **Rela√ß√£o**: Quando ICA = IMA ‚Üí idade de rota√ß√£o √≥tima
- **Aplica√ß√£o**: Determina√ß√£o do momento ideal de corte

### üå≥ **Talh√£o vs Parcela**
- **Talh√£o**: Unidade de manejo florestal (homog√™nea em idade/esp√©cie)
- **Parcela**: Unidade de amostragem do invent√°rio (400m¬≤ t√≠pico)

*O sistema classifica **parcelas por produtividade**, n√£o determina √≠ndice de s√≠tio florestal.*

## üìñ Fundamentos Cient√≠ficos
- **Campos, J.C.C. & Leite, H.G.** - Mensura√ß√£o Florestal: Perguntas e Respostas
- **Scolforo, J.R.S.** - Biometria Florestal
- **Burkhart, H.E. & Tom√©, M.** - Modeling Forest Trees and Stands

### **Modelos Volum√©tricos**
- **Husch, B., Beers, T.W. & Kershaw Jr., J.A.** - Forest Mensuration
- **West, P.W.** - Tree and Forest Measurement

### **Metodologia Estat√≠stica**
- **Ratkowsky, D.A.** - Handbook of Nonlinear Regression Models
- **Draper, N.R. & Smith, H.** - Applied Regression Analysis

## üåü Caracter√≠sticas Avan√ßadas

### **üîÑ Fluxo Integrado √önico**
- **Sele√ß√£o autom√°tica** dos melhores modelos
- **Integra√ß√£o fluida** entre etapas
- **Valida√ß√£o cruzada** autom√°tica
- **Diagn√≥stico de qualidade** integrado

### **üìä Interface Profissional**
- **Abas organizadas** por modelo
- **Equa√ß√µes LaTeX** matematicamente corretas
- **Gr√°ficos de alta qualidade** para publica√ß√£o
- **Relat√≥rios executivos** prontos para gest√£o

### **üîç An√°lise Estat√≠stica Robusta**
- **M√∫ltiplas m√©tricas** de avalia√ß√£o
- **An√°lise de res√≠duos** detalhada
- **Teste de signific√¢ncia** para modelos lineares
- **Rankings autom√°ticos** por performance

### **üíæ Exporta√ß√£o Vers√°til**
- **M√∫ltiplos formatos** (CSV, Markdown)
- **Relat√≥rios t√©cnicos** completos
- **Dados processados** para uso posterior
- **Coeficientes** para implementa√ß√£o operacional

### **üìä Classifica√ß√£o Inteligente**
- **Estratifica√ß√£o por produtividade** baseada em quartis
- **Classes Alta/M√©dia/Baixa** automaticamente definidas
- **An√°lise por talh√£o** com m√©tricas consolidadas
- **IMA e produtividade** calculados automaticamente

## ü§ù Contribui√ß√µes

Contribui√ß√µes s√£o muito bem-vindas! Por favor:

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/NovaFuncionalidade`)
3. Commit suas mudan√ßas (`git commit -m 'Adiciona nova funcionalidade'`)
4. Push para a branch (`git push origin feature/NovaFuncionalidade`)
5. Abra um Pull Request

### **√Åreas para Contribui√ß√£o**
- üå± Novos modelos hipsom√©tricos/volum√©tricos
- üìä Melhorias nas visualiza√ß√µes
- üîß Otimiza√ß√£o de performance
- üìù Documenta√ß√£o e exemplos
- üß™ Testes automatizados
- üåç Internacionaliza√ß√£o

## üìù Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo `LICENSE` para detalhes.

## üìß Suporte e Contato

Para d√∫vidas, sugest√µes ou problemas:
- üìß **Email**: [seu-email@exemplo.com]
- üêõ **Issues**: Abra uma issue no GitHub
- üí¨ **Discuss√µes**: Use as Discussions do GitHub
- üìñ **Wiki**: Consulte a documenta√ß√£o completa

## üîÑ Changelog

### v2.0.0 - Sistema Integrado (Atual)
- ‚úÖ **Integra√ß√£o completa** das 3 etapas
- ‚úÖ **7 modelos hipsom√©tricos** + 4 volum√©tricos
- ‚úÖ **An√°lise detalhada** por modelo individual
- ‚úÖ **Sele√ß√£o autom√°tica** dos melhores modelos
- ‚úÖ **Interface moderna** com abas organizadas
- ‚úÖ **Relat√≥rios executivos** completos
- ‚úÖ **M√∫ltiplas engines Excel** para m√°xima compatibilidade

### v1.0.0 - Modelos Hipsom√©tricos
- ‚úÖ Sistema b√°sico de modelos hipsom√©tricos
- ‚úÖ Interface Streamlit inicial
- ‚úÖ Exporta√ß√£o de resultados

---

**üå≤ Desenvolvido para a comunidade florestal brasileira com foco em excel√™ncia t√©cnica e facilidade de uso** üáßüá∑

*Sistema que une rigor cient√≠fico, interface moderna e praticidade operacional para revolucionar a an√°lise de invent√°rios florestais.*
